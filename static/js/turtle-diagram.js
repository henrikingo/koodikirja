$(function() {
  var turtleDiagrams = {
    suunnat1: {
      height: 300,
      width: 400,
      offsetY: 50,
      commands: [["rt",[0]],["fd",[120]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["rt",[0]],["fd",[20]],["lt",[0]],["pendown",[]],["text",["FD 100"]],["penup",[]],["rt",[180]],["fd",[140]],["lt",[180]],["pendown",[]],["rt",[90]],["fd",[120]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[90]],["penup",[]],["rt",[0]],["fd",[20]],["lt",[0]],["pendown",[]],["text",["LT 90"]],["penup",[]],["rt",[180]],["fd",[20]],["rt",[90]],["fd",[120]],["pendown",[]],["rt",[0]],["fd",[120]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["rt",[90]],["penup",[]],["rt",[0]],["fd",[20]],["lt",[0]],["pendown",[]],["text",["RT 90"]],["penup",[]],["rt",[180]],["fd",[20]],["lt",[180]],["pendown",[]],["penup",[]],["rt",[90]],["fd",[120]],["lt",[90]],["pendown",[]]]
    },
    suunnat2: {
      height: 500,
      commands: [["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[0]],["text",[0]],["rt",[0]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[45]],["text",[45]],["rt",[45]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[90]],["text",[90]],["rt",[90]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[135]],["text",[135]],["rt",[135]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[180]],["text",[180]],["rt",[180]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[225]],["text",[225]],["rt",[225]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[270]],["text",[270]],["rt",[270]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]],["rt",[0]],["fd",[200]],["rt",[135]],["fd",[10]],["rt",[180]],["penup",[]],["fd",[10]],["lt",[90]],["pendown",[]],["fd",[10]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[45]],["pendown",[]],["lt",[0]],["penup",[]],["fd",[20]],["lt",[315]],["text",[315]],["rt",[315]],["penup",[]],["rt",[180]],["fd",[220]],["lt",[180]],["pendown",[]],["rt",[45]]]
    },
    mkirjain: {
      height: 300,
      width: 400,
      commands: [["penup",[]],["lt",[135]],["fd",[120]],["rt",[135]],["pendown",[]],["fd",[200]],["penup",[]],["rt",[0]],["fd",[10]],["lt",[0]],["pendown",[]],["text",["RT 135"]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[180]],["pendown",[]],["rt",[135]],["fd",[120]],["lt",[135]],["penup",[]],["rt",[180]],["fd",[20]],["lt",[180]],["pendown",[]],["text",["LT 90"]],["penup",[]],["rt",[0]],["fd",[20]],["lt",[0]],["pendown",[]],["rt",[45]],["fd",[120]],["lt",[45]],["penup",[]],["rt",[0]],["fd",[10]],["lt",[0]],["pendown",[]],["text",["RT 135"]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[180]],["pendown",[]],["rt",[180]],["fd",[200]]]
    },
    kaksiviivaa: {
      height: 300,
      width: 400,
      offsetX: 50,
      commands: [["penup",[]],["lt",[135]],["fd",[120]],["rt",[135]],["pendown",[]],["fd",[200]],["penup",[]],["rt",[90]],["fd",[200]],["pendown",[]],["rt",[90]],["fd",[200]],["penup",[]],["rt",[180]],["fd",[180]],["rt",[90]],["fd",[20]],["lt",[90]],["text",["fd 100"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]],["text",["penup"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]],["text",["rt 90"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]],["text",["fd 100"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]],["text",["rt 90"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]],["text",["pendown"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]],["text",["fd 100"]],["penup",[]],["rt",[180]],["fd",[25]],["lt",[180]],["pendown",[]]]
    },
    neliovaiheet: {
      height: 300,
      width: 640,
      offsetY: 100,
      commands: [["penup",[]],["lt",[90]],["fd",[220]],["rt",[90]],["pendown",[]],["penup",[]],["rt",[270]],["fd",[80]],["lt",[270]],["pendown",[]],["text",["FD 100"]],["penup",[]],["rt",[90]],["fd",[80]],["lt",[90]],["pendown",[]],["fd",[200]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[180]],["pendown",[]],["lt",[90]],["fd",[5]],["rt",[104.03624346792648]],["fd",[20.615528128088304]],["rt",[151.92751306414704]],["fd",[20.615528128088304]],["rt",[104.03624346792648]],["fd",[5]],["rt",[90]],["penup",[]],["rt",[0]],["fd",[10]],["lt",[0]],["pendown",[]],["penup",[]],["rt",[180]],["fd",[200]],["lt",[180]],["pendown",[]],["penup",[]],["rt",[90]],["fd",[50]],["lt",[90]],["pendown",[]],["fd",[200]],["rt",[90]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[180]],["pendown",[]],["lt",[90]],["fd",[5]],["rt",[104.03624346792648]],["fd",[20.615528128088304]],["rt",[151.92751306414704]],["fd",[20.615528128088304]],["rt",[104.03624346792648]],["fd",[5]],["rt",[90]],["penup",[]],["rt",[0]],["fd",[10]],["lt",[0]],["pendown",[]],["penup",[]],["rt",[180]],["fd",[30]],["lt",[180]],["pendown",[]],["text",["RT 90"]],["penup",[]],["rt",[360]],["fd",[30]],["lt",[360]],["pendown",[]],["lt",[90]],["penup",[]],["rt",[180]],["fd",[200]],["lt",[180]],["pendown",[]],["penup",[]],["rt",[90]],["fd",[30]],["lt",[90]],["pendown",[]],["fd",[200]],["rt",[90]],["fd",[200]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[180]],["pendown",[]],["lt",[90]],["fd",[5]],["rt",[104.03624346792648]],["fd",[20.615528128088304]],["rt",[151.92751306414704]],["fd",[20.615528128088304]],["rt",[104.03624346792648]],["fd",[5]],["rt",[90]],["penup",[]],["rt",[0]],["fd",[10]],["lt",[0]],["pendown",[]],["lt",[90]],["penup",[]],["rt",[260]],["fd",[150]],["lt",[260]],["pendown",[]],["text",["FD 100"]],["penup",[]],["rt",[440]],["fd",[150]],["lt",[440]],["pendown",[]],["penup",[]],["rt",[180]],["fd",[200]],["lt",[180]],["pendown",[]],["penup",[]],["rt",[90]],["fd",[30]],["lt",[90]],["pendown",[]],["fd",[200]],["rt",[90]],["fd",[200]],["rt",[90]],["penup",[]],["rt",[180]],["fd",[10]],["lt",[180]],["pendown",[]],["lt",[90]],["fd",[5]],["rt",[104.03624346792648]],["fd",[20.615528128088304]],["rt",[151.92751306414704]],["fd",[20.615528128088304]],["rt",[104.03624346792648]],["fd",[5]],["rt",[90]],["penup",[]],["rt",[0]],["fd",[10]],["lt",[0]],["pendown",[]],["lt",[180]],["penup",[]],["rt",[256]],["fd",[120]],["lt",[256]],["pendown",[]],["text",["RT 90"]],["penup",[]],["rt",[436]],["fd",[120]],["lt",[436]],["pendown",[]],["penup",[]],["rt",[180]],["fd",[200]],["lt",[180]],["pendown",[]]]
    }
  }

  $(".turtle-diagram").each(function() {
    var elem = $(this)
    var id = elem.attr("data-id")
    var diagram = turtleDiagrams[id]
    var turtle = Turtle(elem, diagram.width || 640, diagram.height || 500)
    var drawn = false
    whenInView(elem, function(inView) {
      if (inView && !drawn) {
        drawn = true
        if (diagram.offsetY) {
          turtle.penup()
          turtle.rt(180)
          turtle.fd(diagram.offsetY)
          turtle.rt(180)
          turtle.pendown()
        }
        if (diagram.offsetX) {
          turtle.penup()
          turtle.lt(90)
          turtle.fd(diagram.offsetX)
          turtle.rt(90)
          turtle.pendown()
        }
        var calls = diagram.commands
        calls.forEach(function(call) {
          if (call instanceof Array)
            turtle[call[0]].apply(turtle, call[1])
          else
            turtle[call.key].apply(turtle, call.args)
        })
      }
    })
  })
})

